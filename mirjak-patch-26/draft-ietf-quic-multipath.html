<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Multipath Extension for QUIC</title>
<meta content="刘彦梅 (Yanmei Liu)" name="author">
<meta content="马云飞 (Yunfei Ma)" name="author">
<meta content="Quentin De Coninck" name="author">
<meta content="Olivier Bonaventure" name="author">
<meta content="Christian Huitema" name="author">
<meta content="Mirja Kuehlewind" name="author">
<meta content="
       This document specifies a multipath extension for the QUIC protocol to
enable the simultaneous usage of multiple paths for a single connection. 
    " name="description">
<meta content="xml2rfc 3.28.1" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-quic-multipath-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.1
    Python 3.12.10
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-quic-multipath.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Multipath QUIC</td>
<td class="right">June 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Liu, et al.</td>
<td class="center">Expires 15 December 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">QUIC Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-quic-multipath-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-06-13" class="published">13 June 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-12-15">15 December 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">
<span class="non-ascii">刘彦梅</span> (<span class="ascii">Y. Liu</span>), <span class="editor">Ed.</span>
</div>
<div class="org">Alibaba Inc.</div>
</div>
<div class="author">
      <div class="author-name">
<span class="non-ascii">马云飞</span> (<span class="ascii">Y. Ma</span>)</div>
<div class="org">Uber Technologies Inc.</div>
</div>
<div class="author">
      <div class="author-name">Q. De Coninck, <span class="editor">Ed.</span>
</div>
<div class="org">University of Mons (UMONS)</div>
</div>
<div class="author">
      <div class="author-name">O. Bonaventure</div>
<div class="org">UCLouvain and Tessares</div>
</div>
<div class="author">
      <div class="author-name">C. Huitema</div>
<div class="org">Private Octopus Inc.</div>
</div>
<div class="author">
      <div class="author-name">M. Kuehlewind, <span class="editor">Ed.</span>
</div>
<div class="org">Ericsson</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Multipath Extension for QUIC</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a multipath extension for the QUIC protocol to
enable the simultaneous usage of multiple paths for a single connection.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    QUIC Working Group mailing list (quic@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/quic/">https://mailarchive.ietf.org/arch/browse/quic/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/quicwg/multipath">https://github.com/quicwg/multipath</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 15 December 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-transport-handshake-and-cry" class="internal xref">Transport Handshake and Cryptographic Packet Protection</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-initial_max_path_id-transpo" class="internal xref">initial_max_path_id Transport Parameter</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-relation-to-other-transport" class="internal xref">Relation to Other Transport Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-handling-ack-and-path_ack-i" class="internal xref">Handling ACK and PATH_ACK in 0-RTT and 1-RTT</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-nonce-calculation-after-han" class="internal xref">Nonce Calculation after Handshake Completion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="auto internal xref">2.5</a>.  <a href="#name-key-phase-update-process" class="internal xref">Key Phase Update Process</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-path-management" class="internal xref">Path Management</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-path-initiation-and-validat" class="internal xref">Path Initiation and Validation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-path-establishment-example" class="internal xref">Path Establishment Example</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-relation-to-probing-and-mig" class="internal xref">Relation to Probing and Migration</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="auto internal xref">3.1.3</a>.  <a href="#name-address-validation-token" class="internal xref">Address Validation Token</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-handling-connection-ids" class="internal xref">Handling Connection IDs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-issuing-new-connection-ids" class="internal xref">Issuing New Connection IDs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-rotating-and-retiring-conne" class="internal xref">Rotating and Retiring Connection IDs</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-path-status-management" class="internal xref">Path Status Management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-path-close" class="internal xref">Path Close</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-path-closure-example" class="internal xref">Path Closure Example</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="auto internal xref">3.4.2</a>.  <a href="#name-avoiding-spurious-stateless" class="internal xref">Avoiding Spurious Stateless Resets</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="auto internal xref">3.4.3</a>.  <a href="#name-handling-path_ack-for-aband" class="internal xref">Handling PATH_ACK for Abandoned Paths</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-new-frames" class="internal xref">New Frames</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-path_ack-frame" class="internal xref">PATH_ACK Frame</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-path_abandon-frame" class="internal xref">PATH_ABANDON Frame</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-error-codes" class="internal xref">Error Codes</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-path_available-and-path_bac" class="internal xref">PATH_AVAILABLE and PATH_BACKUP frames</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-path_new_connection_id-fram" class="internal xref">PATH_NEW_CONNECTION_ID frame</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-path_retire_connection_id-f" class="internal xref">PATH_RETIRE_CONNECTION_ID frame</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-max_path_id-frame" class="internal xref">MAX_PATH_ID frame</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-paths_blocked-and-path_cids" class="internal xref">PATHS_BLOCKED and PATH_CIDS_BLOCKED frames</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-implementation-consideratio" class="internal xref">Implementation Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-cid-changes-migration-and-n" class="internal xref">CID Changes, Migration, and NAT Rebindings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-using-multiple-paths-on-the" class="internal xref">Using Multiple Paths on the Same 4-tuple</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-congestion-control" class="internal xref">Congestion Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-computing-path-rtt" class="internal xref">Computing Path RTT</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-packet-scheduling" class="internal xref">Packet Scheduling</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="auto internal xref">5.6</a>.  <a href="#name-retransmissions" class="internal xref">Retransmissions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="auto internal xref">5.7</a>.  <a href="#name-pto-expiration" class="internal xref">PTO Expiration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a href="#section-5.8" class="auto internal xref">5.8</a>.  <a href="#name-paths-having-different-pmtu" class="internal xref">Paths Having Different PMTU Sizes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a href="#section-5.9" class="auto internal xref">5.9</a>.  <a href="#name-idle-timeout-and-keep-alive" class="internal xref">Idle Timeout and Keep-Alives</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-memory-allocation-for-per-p" class="internal xref">Memory Allocation for Per-Path Resources</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-request-forgery-with-spoofe" class="internal xref">Request Forgery with Spoofed Address</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-cryptographic-handshake-and" class="internal xref">Cryptographic handshake and AEAD Nonce</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document specifies an extension to QUIC version 1 <span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>
to enable the simultaneous usage of multiple paths for a single
connection, using the same or different 4-tuples (of source/destination
port number and source/destination IP address).<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Connection migration as specified in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-9" class="relref">Section 9</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>
directs a peer to switch sending through
a new preferred path, and, if successful, to release resources
associated with the old path. The multipath extension specified in this document
builds on this mechanism but introduces a path identifier, or path ID,
to manage connection IDs and packet number spaces per path, enabling the use
of multiple paths simultaneously.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The connection ID of a packet binds the packet to a path ID, and therefore
to a packet number space. That means each connection ID is associated with exactly one path ID
but multiple connection IDs are usually issued for each path ID.
The same path ID is used in both directions, starting with 0 for the initial path.
Path ID are generated monotonically increasing and cannot be reused.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This extension uses multiple packet number spaces, one for each path.
Each path ID-specific packet number space starts at packet number 0.
As such, each path maintains distinct packet number states for sending and receiving packets, as in <span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>.
Using multiple packet number spaces enables direct use of the
loss detection and congestion control mechanisms defined in
<span>[<a href="#QUIC-RECOVERY" class="cite xref">QUIC-RECOVERY</a>]</span> on a per-path basis.
However, use of multiple packet number spaces requires
non-zero connection IDs in order to identify the path and the respective
packet number space as well as a modified AEAD calculation including the
path ID (see <a href="#nonce" class="auto internal xref">Section 2.4</a>).<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">As such, this extension specifies a departure from the specification of
path management in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-9" class="relref">Section 9</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> and therefore
requires a new transport parameter, as specified in <a href="#nego" class="auto internal xref">Section 2.1</a>, to indicate
support of the multipath extension specified in this document.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Further, this document specifies the needed path management mechanisms for path
initiation in <a href="#path-initiation" class="auto internal xref">Section 3.1</a>, handling of per-path connection IDs in <a href="#consume-retire-cid" class="auto internal xref">Section 3.2</a>,
signaling of preferred path usage in <a href="#path-state" class="auto internal xref">Section 3.3</a>, and explicit
removal of paths that have been abandoned in <a href="#path-close" class="auto internal xref">Section 3.4</a>.
Note that in this extension, a QUIC server does not initiate the creation
of a path, but it has to validate a new path created by a client.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This extension does not cover address discovery and management. Addresses
and the actual decision to setup or tear down paths are assumed
to be handled by the application. But this document does not prevent future extensions from
defining mechanisms to cope with the remaining scenarios.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">Further, this document does not specify scheduling algorithms that define
how multiple, simultaneously open paths are used to send packets.
As these differ depending on application requirements,
only some basic implementation guidance is discussed in <a href="#impl-consideration" class="auto internal xref">Section 5</a>.
This extension can be used with different scheduling algorithms that,
e.g., can range from support for failover to simulatenous
use of the aggregated capacity across all open paths.
There are currently no IETF specifications hat define scheduling
algorithms for simultaneously (concurrently) using multiple paths.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">Specifically, while failover between Wi-Fi
and mobile networks is a well-known multipath use case,
it only temporarily uses two paths at the same time
to avoid transmission pauses.
Simultaneous path usage generally, however, needs more consideration
than specified in this document to avoid negative performance
impacts, e.g., when stream data is distributed over multiple paths with
different delays.<a href="#section-1-9" class="pilcrow">¶</a></p>
<div id="definition">
<section id="section-1.1">
        <h3 id="name-conventions-and-definitions">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
"OPTIONAL" in this document are to be interpreted as described in BCP 14
<span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all
capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">We assume that the reader is familiar with the terminology used in
<span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>. When this document uses the term "path", it refers
to the notion of "network path" used in <span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="transport-handshake-and-cryptographic-packet-protection">
<section id="section-2">
      <h2 id="name-transport-handshake-and-cry">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-transport-handshake-and-cry" class="section-name selfRef">Transport Handshake and Cryptographic Packet Protection</a>
      </h2>
<p id="section-2-1">This document defines a new transport parameter initial_max_path_id
to indicate the support of the multipath extension.
If any of the endpoints does not advertise the initial_max_path_id transport
parameter, then the endpoints MUST NOT use any frame or
mechanism defined in this document.
If the use of the multipath extension is agreed after handshake completion,
a new AEAD usage applies to all 1-RTT packets, as specified in Section <a href="#nonce" class="auto internal xref">Section 2.4</a>
and new paths can be used, as specified in Section <a href="#path-management" class="auto internal xref">Section 3</a>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="nego">
<section id="section-2.1">
        <h3 id="name-initial_max_path_id-transpo">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-initial_max_path_id-transpo" class="section-name selfRef">initial_max_path_id Transport Parameter</a>
        </h3>
<p id="section-2.1-1">The new transport parameter is defined as follows:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">
            <p id="section-2.1-2.1.1">initial_max_path_id (current version uses 0x0f739bbc1b666d0d): a
variable-length integer specifying the maximum path ID
an endpoint is willing to maintain at connection initiation.
This value MUST NOT exceed 2^32-1, the maximum allowed value for the path ID due to
restrictions on the nonce calculation (see <a href="#nonce" class="auto internal xref">Section 2.4</a>).<a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-3">The initial_max_path_id transport parameter limits the initial
maximum number of open paths that can be used during a connection.
For example, if initial_max_path_id is set to 1, only connection IDs
associated with path IDs 0 and 1 should be issued by the peer.
If an endpoint receives an initial_max_path_id transport parameter with value 0,
the peer aims to enable the multipath extension without allowing extra paths immediately.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">Setting initial_max_path_id parameter is equivalent to sending a
MAX_PATH_ID frame (<a href="#max-paths-frame" class="auto internal xref">Section 4.6</a>) with the same value.
As such to allow for the use of more paths later,
endpoints can send the MAX_PATH_ID frame to increase the maximum allowed path ID.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">If an initial_max_path_id transport parameter value higher than 2^32-1
is received, the receiver MUST close the connection with an error of type
TRANSPORT_PARAMETER_ERROR.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">When advertising the initial_max_path_id transport parameter, endpoints
MUST use Source and Destination Connection IDs with non-zero lengths.
If an initial_max_path_id transport
parameter is received and the carrying packet contains a zero-length
connection ID, the receiver MUST treat this as a connection error of type
PROTOCOL_VIOLATION and close the connection.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.1-7">Cipher suites with a nonce shorter than 12 bytes cannot be used together with
the multipath extension. If such a cipher suite is selected and the use of the
multipath extension is supported, endpoints MUST abort the handshake with a
an error of type TRANSPORT_PARAMETER_ERROR.<a href="#section-2.1-7" class="pilcrow">¶</a></p>
<p id="section-2.1-8">The initial_max_path_id parameter MUST NOT be remembered
for use in a subsequent connection (<span><a href="https://rfc-editor.org/rfc/rfc9000#section-7.4.1" class="relref">Section 7.4.1</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>).<a href="#section-2.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="relation-to-other-transport-parameters">
<section id="section-2.2">
        <h3 id="name-relation-to-other-transport">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-relation-to-other-transport" class="section-name selfRef">Relation to Other Transport Parameters</a>
        </h3>
<p id="section-2.2-1">When the QUIC multipath extension is used, the active_connection_id_limit transport parameter
<span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> limits the maximum number of active connection IDs per path.
As defined in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-5.1.1" class="relref">Section 5.1.1</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> connection IDs that are issued
and not retired are considered active.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">If an endpoint receives a disable_active_migration transport parameter,
it is forbidden to establish new paths to the peer's handshake address. However,
establishment of additional paths to other peer addresses
(e.g carried by peer’s preferred_address) is immediately valid.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">If the server uses the preferred_address transport parameter, clients
cannot assume that the initial server address and the addresses
contained in this parameter can be simultaneously used for multipath
(<span><a href="https://rfc-editor.org/rfc/rfc9000#section-9.6.2" class="relref">Section 9.6.2</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>).
Use of the preferred address with the same local address is considered as a migration event
that does not change the path ID. A such, the path ID for
the connection ID specified in the preferred_address transport parameter is 0.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="handling-ack-and-pathack-in-0-rtt-and-1-rtt">
<section id="section-2.3">
        <h3 id="name-handling-ack-and-path_ack-i">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-handling-ack-and-path_ack-i" class="section-name selfRef">Handling ACK and PATH_ACK in 0-RTT and 1-RTT</a>
        </h3>
<p id="section-2.3-1">The PATH_ACK frame (see <a href="#mp-ack-frame" class="auto internal xref">Section 4.1</a>) is used to
acknowledge 1-RTT packets.
Compared to the ACK frame, as specified in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-19.3" class="relref">Section 19.3</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>, the PATH_ACK frame additionally
contains the path ID to identify the path-specific packet number space.
ACK frames when used with the multipath extension acknowledge packets for the path with path ID 0.
As multipath support is unknown during the handshake, acknowledgments of
Initial and Handshake packets are sent using ACK frames.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">After the handshake concluded with support for the multipath extension,
endpoints SHOULD use PATH_ACK frames instead of ACK frames,
including for so far unacknowledged 0-RTT packets using Path ID 0.
Endpoints MUST still process ACK frames that acknowledge 0-RTT packets or 1-RTT packets.
For example, a sender may negotiate multipath support for later use and keep
only the initial path with path ID 0 for a while. During this single-path period,
the sender might prefer to send ACK frames.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="nonce">
<section id="section-2.4">
        <h3 id="name-nonce-calculation-after-han">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-nonce-calculation-after-han" class="section-name selfRef">Nonce Calculation after Handshake Completion</a>
        </h3>
<p id="section-2.4-1"><span><a href="https://rfc-editor.org/rfc/rfc9001#section-5.3" class="relref">Section 5.3</a> of [<a href="#QUIC-TLS" class="cite xref">QUIC-TLS</a>]</span> specifies AEAD usage, and in particular
the use of a nonce, N, formed by combining the packet protection IV
with the packet number. When multiple packet number spaces are used,
the packet number alone would not guarantee the uniqueness of the nonce.
Therefore, the nonce N is calculated for 1-RTT if the multipath extension is used
by combining the packet protection
IV with the packet number and with the least significant 32 bits of the
path ID. In order to guarantee the uniqueness of the nonce, the path ID
is limited to a max value of 2^32-1, as specified in Section <a href="#nego" class="auto internal xref">Section 2.1</a><a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">To calculate the nonce, a 96-bit path-and-packet-number is composed of the least
significant 32 bits of the path ID in network byte order,
two zero bits, and the 62 bits of the reconstructed QUIC packet number in
network byte order. The IV length is equal to the nonce length. If the IV is larger than 96 bits, the path-and-packet-number
is left-padded with zeros to the size of the IV. The exclusive OR of the padded
packet number and the IV forms the AEAD nonce. An AEAD algorithm where the nonce length
is less than 12 bytes MUST NOT be used with the QUIC multipath extension.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3">For example, assuming the IV value is <code>6b26114b9cba2b63a9e8dd4f</code>,
the path ID is <code>3</code>, and the packet number is <code>aead</code>,
the nonce will be set to <code>6b2611489cba2b63a9e873e2</code>.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multipath-key-update">
<section id="section-2.5">
        <h3 id="name-key-phase-update-process">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-key-phase-update-process" class="section-name selfRef">Key Phase Update Process</a>
        </h3>
<p id="section-2.5-1">The Key Phase bit update process is specified in
<span><a href="https://rfc-editor.org/rfc/rfc9001#section-6" class="relref">Section 6</a> of [<a href="#QUIC-TLS" class="cite xref">QUIC-TLS</a>]</span>. The general principles of key update
are not changed in this specification. Following <span>[<a href="#QUIC-TLS" class="cite xref">QUIC-TLS</a>]</span>, the Key Phase bit is used to
indicate which packet protection keys are used to protect the packet.
The Key Phase bit is toggled to signal each subsequent key update.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.5-2">Because of network delays, packets protected with the older key might
arrive later than the packets protected with the new key, however receivers
can solely rely on the Key Phase bit to determine the corresponding packet
protection key, assuming that there is sufficient interval between two
consecutive key updates (<span><a href="https://rfc-editor.org/rfc/rfc9001#section-6.5" class="relref">Section 6.5</a> of [<a href="#QUIC-TLS" class="cite xref">QUIC-TLS</a>]</span>).<a href="#section-2.5-2" class="pilcrow">¶</a></p>
<p id="section-2.5-3">When this specification is used, endpoints SHOULD wait for at least three times
the largest PTO among all the paths before initiating a new key update
after receiving an acknowledgment that confirms the receipt of the previous key
update. This interval is different from that in <span>[<a href="#QUIC-TLS" class="cite xref">QUIC-TLS</a>]</span>
which used three times the PTO of the sole single path.<a href="#section-2.5-3" class="pilcrow">¶</a></p>
<p id="section-2.5-4">The choice of three times the largest PTO is a trade-off.
Packets that arrive after their decryption key has been discarded will be dropped.
Longer delays reduce the probability of losing packets but keeping old keys
longer can negatively impact the security of the protocol.
The use of three times the largest PTO aims to minimize packet lost for all paths
and therefore limits the impact on performance.<a href="#section-2.5-4" class="pilcrow">¶</a></p>
<p id="section-2.5-5">Following <span><a href="https://rfc-editor.org/rfc/rfc9001#section-5.4" class="relref">Section 5.4</a> of [<a href="#QUIC-TLS" class="cite xref">QUIC-TLS</a>]</span>, the Key Phase bit is protected,
so sending multiple packets with Key Phase bit flipping at the same time
should not cause linkability issues.<a href="#section-2.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="path-management">
<section id="section-3">
      <h2 id="name-path-management">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-path-management" class="section-name selfRef">Path Management</a>
      </h2>
<p id="section-3-1">After completing the handshake indicating
multipath support, endpoints can start using multiple paths.
An endpoint can open a new path when both endpoints
have issued available connection IDs for at least one unused, common path ID,
as the same path ID is used in both directions.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">This documents specfies path initiation (see <a href="#path-initiation" class="auto internal xref">Section 3.1</a>),
issuing and retirement of per-path connection IDs (see
<a href="#consume-retire-cid" class="auto internal xref">Section 3.2</a>), path status management (see <a href="#path-state" class="auto internal xref">Section 3.3</a>) and
path closure (see <a href="#path-close" class="auto internal xref">Section 3.4</a>).
However, this document does not specify when a client decides to initiate or close a path,
or how multiple open paths are used for sending.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">For path management this extension specifies the following frames in <a href="#frames" class="auto internal xref">Section 4</a>:<a href="#section-3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-4.1">
          <p id="section-3-4.1.1">PATH_ABANDON (see <a href="#path-abandon-frame" class="auto internal xref">Section 4.2</a>)<a href="#section-3-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-4.2">
          <p id="section-3-4.2.1">PATH_BACKUP (see <a href="#path-backup-available-frame" class="auto internal xref">Section 4.3</a>)<a href="#section-3-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-4.3">
          <p id="section-3-4.3.1">PATH_AVAILABLE (see <a href="#path-backup-available-frame" class="auto internal xref">Section 4.3</a>)<a href="#section-3-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-4.4">
          <p id="section-3-4.4.1">PATH_NEW_CONNECTION_ID (see <a href="#mp-new-conn-id-frame" class="auto internal xref">Section 4.4</a>)<a href="#section-3-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-4.5">
          <p id="section-3-4.5.1">PATH_RETIRE_CONNECTION_ID (see <a href="#mp-retire-conn-id-frame" class="auto internal xref">Section 4.5</a>)<a href="#section-3-4.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-4.6">
          <p id="section-3-4.6.1">MAX_PATH_ID (see <a href="#max-paths-frame" class="auto internal xref">Section 4.6</a>)<a href="#section-3-4.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-4.7">
          <p id="section-3-4.7.1">PATHS_BLOCKED (see <a href="#paths-and-cids-blocked-frame" class="auto internal xref">Section 4.7</a>)<a href="#section-3-4.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-4.8">
          <p id="section-3-4.8.1">PATH_CIDS_BLOCKED (see <a href="#paths-and-cids-blocked-frame" class="auto internal xref">Section 4.7</a>)<a href="#section-3-4.8.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="path-initiation">
<section id="section-3.1">
        <h3 id="name-path-initiation-and-validat">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-path-initiation-and-validat" class="section-name selfRef">Path Initiation and Validation</a>
        </h3>
<p id="section-3.1-1">To open a new path, an endpoint MUST use a new connection ID associated
with an unused path ID.
When sending a PATH_RESPONSE frame, an endpoint MUST use a connection ID associated to
the same path ID as used in the packet that contained the PATH_CHALLENGE frame.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">A client that wants to use an
additional path MUST validate the peer's address before sending any data packets
as described in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-8.2" class="relref">Section 8.2</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>,
unless it has previously validated the 4-tuple used for that path.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">After receiving packets from the
client on a new path, if the server decides to use the new path,
the server MUST validate the peer's address before sending any data packets
as described in (<span><a href="https://rfc-editor.org/rfc/rfc9000#section-8.2" class="relref">Section 8.2</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>),
unless it has previously validated the 4-tuple used for that path.
Until the client's address is
validated, the anti-amplification limit from <span><a href="https://rfc-editor.org/rfc/rfc9000#section-8" class="relref">Section 8</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>
applies.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">The server may receive packets for a yet unused path ID that do not
contain a PATH_CHALLENGE frame. Such packets are valid if they can be properly decrypted
given a valid connection ID.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">Each endpoint MUST also validate that a minimum QUIC packet MTU of 1200 bytes is supported
on the path. This can be done during initial path validation or separately later if
the amplification limit prevents it initially, as specified in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-8.2.1" class="relref">Section 8.2.1</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">An endpoint that receives packets on a new path and does not want to establish
this path is expected to close the path by sending a PATH_ABANDON
on another path, as specified in <a href="#path-close" class="auto internal xref">Section 3.4</a>.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7">An endpoint that has no active connection ID for this path or
lacks other resource to immediately configure a new path could
delay sending the PATH_RESPONSE until sufficient resource are available.
Long delays may cause the peer to repeat the PATH_CHALLENGE and eventually
send a PATH_ABANDON, in which case the procedures specified in
Section <a href="#path-close" class="auto internal xref">Section 3.4</a> apply.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">PATH_ACK frames (see <a href="#mp-ack-frame" class="auto internal xref">Section 4.1</a>) can be returned on any path.
If the PATH_ACK is preferred to be sent on the same path as the acknowledged
packet (see <a href="#compute-rtt" class="auto internal xref">Section 5.4</a> for further guidance), it can be beneficial
to bundle a PATH_ACK frame with the PATH_RESPONSE frame during
path validation.<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1-9">If validation succeeds, the client can continue to use the path.
If validation fails, the client MUST NOT use the path and can
remove any status associated to the path initiation attempt.
As the used path ID is anyway consumed,
the endpoint MUST explicitly close the path, as specified in
<a href="#path-close" class="auto internal xref">Section 3.4</a>.<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<div id="path-establishment-example">
<section id="section-3.1.1">
          <h4 id="name-path-establishment-example">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-path-establishment-example" class="section-name selfRef">Path Establishment Example</a>
          </h4>
<p id="section-3.1.1-1">In the example below it is assumed that both endpoints have
indicated an initial_max_path_id value of at least 2, which means
both endpoints can use path IDs 0, 1, and 2. Note that
path ID 0 is already used for the initial path.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<span id="name-example-of-new-path-establi"></span><div id="fig-example-new-path">
<figure id="figure-1">
            <div class="alignLeft art-text artwork" id="section-3.1.1-2.1">
<pre>
   Client                                                  Server

   (Exchanges start on default path)
   1-RTT[]: PATH_NEW_CONNECTION_ID[C1, Seq=0, PathID=1] --&gt;
             &lt;-- 1-RTT[]: PATH_NEW_CONNECTION_ID[S1, Seq=0, PathID=1]
             &lt;-- 1-RTT[]: PATH_NEW_CONNECTION_ID[S2, Seq=0, PathID=2]
   ...
   (starts new path)
   1-RTT[0]: DCID=S1, PATH_CHALLENGE[X] --&gt;
                           Checks AEAD using nonce(path ID 1, PN 0)
        &lt;-- 1-RTT[0]: DCID=C1, PATH_RESPONSE[X], PATH_CHALLENGE[Y],
                                             PATH_ACK[PathID=1, PN=0]
   Checks AEAD using nonce(path ID 1, PN 0)
   1-RTT[1]: DCID=S1, PATH_RESPONSE[Y],
            PATH_ACK[PathID=1, PN=0], ... --&gt;

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-example-of-new-path-establi" class="selfRef">Example of new path establishment</a>
            </figcaption></figure>
</div>
<p id="section-3.1.1-3">In <a href="#fig-example-new-path" class="auto internal xref">Figure 1</a>, the endpoints first exchange
new available connection IDs with the PATH_NEW_CONNECTION_ID frame.
In this example, the client provides one connection ID (C1 with
path ID 1), and server provides two connection IDs
(S1 with path ID 1, and S2 with path ID 2).<a href="#section-3.1.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1.1-4">Before the client opens a new path by sending a packet on that path
with a PATH_CHALLENGE frame, it has to check whether there is
an unused connection IDs for the same unused path ID available for each side.
In this example the path ID 1 is used which is the smallest unused path ID available
as recommended in <a href="#consume-retire-cid" class="auto internal xref">Section 3.2</a>.
Respectively, the client chooses the connection ID S1
as the Destination Connection ID of the new path when sending the PATH_CHALLENGE frame.
The server replies with a PATH_RESPONSE bundled with the PATH_ACK using connection ID S1
associated with the same path ID.<a href="#section-3.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="relation-to-probing-and-migration">
<section id="section-3.1.2">
          <h4 id="name-relation-to-probing-and-mig">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-relation-to-probing-and-mig" class="section-name selfRef">Relation to Probing and Migration</a>
          </h4>
<p id="section-3.1.2-1"><span><a href="https://rfc-editor.org/rfc/rfc9000#section-9.1" class="relref">Section 9.1</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> introduces the concept of
"probing" and "non-probing" frames. A packet that contains at least
one "non-probing" frame is a "non-probing" packet. When the multipath extension
is negotiated, the reception of a "non-probing"
packet on a new path with a new so far unused path ID
does not impact the path status of any existing
path. Therefore, any frame can be sent on a new path at any time
as long as the anti-amplification limits
(see <span><a href="https://rfc-editor.org/rfc/rfc9000#section-21.1.1.1" class="relref">Section 21.1.1.1</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>) and the congestion control
limits for this path are respected.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2-2">The receiver may receive a connection ID associated with a used path ID
on different 4-tuples, e.g., due to NAT rebinding. This causes the receiver to initiate
path validation as specified in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-9.3" class="relref">Section 9.3</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>
which MUST use a new connection ID for the same path ID.<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="address-validation-token">
<section id="section-3.1.3">
          <h4 id="name-address-validation-token">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-address-validation-token" class="section-name selfRef">Address Validation Token</a>
          </h4>
<p id="section-3.1.3-1">As specified in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-9.3" class="relref">Section 9.3</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>, the server is expected to send a new
address validation token to a client following the successful validation of a
new client address. The client will receive several tokens. When considering using a token
for subsequent connections, it might be difficult for the client
to pick the "right" token among multiple tokens obtained in a previous connection.
The client is likely to fall back to the strategy specified in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-8.1.3" class="relref">Section 8.1.3</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>,
i.e., pick the last received token. To avoid issues when clients make the "wrong" choice,
a server SHOULD issue tokens that are capable of validating
any of the previously validated addresses. Further guidance on token usage can be
found in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-8.1.3" class="relref">Section 8.1.3</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>.<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="consume-retire-cid">
<section id="section-3.2">
        <h3 id="name-handling-connection-ids">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-handling-connection-ids" class="section-name selfRef">Handling Connection IDs</a>
        </h3>
<p id="section-3.2-1">When the multipath extension is used,
endpoints have to use the PATH_NEW_CONNECTION_ID and PATH_RETIRE_CONNECTION_ID frames
to indicate the respective path ID together with associated sequence number
(see <span><a href="https://rfc-editor.org/rfc/rfc9000#section-5.1.1" class="relref">Section 5.1.1</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>), at least for all paths with a path ID other than 0.
Each path ID has its own connection ID sequence number space whose initial value is 0.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">Endpoints SHOULD also use PATH_NEW_CONNECTION_ID and
PATH_RETIRE_CONNECTION_ID for the initial path with path ID 0.
However, the use of NEW_CONNECTION_ID and RETIRE_CONNECTION_ID
is still valid and endpoints need to process these frames
as corresponding to path ID 0.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<div id="issuing-new-connection-ids">
<section id="section-3.2.1">
          <h4 id="name-issuing-new-connection-ids">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-issuing-new-connection-ids" class="section-name selfRef">Issuing New Connection IDs</a>
          </h4>
<p id="section-3.2.1-1">In order to let the peer open new paths, it is RECOMMENDED to proactively
issue at least one Connection ID for each unused path ID up to the
minimum of the peer's and the local maximum path ID limits.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">If for any reason an endpoint does not want to issue connection IDs for all
unused path ID, it SHOULD NOT introduce discontinuity
in the issuing of path IDs as path initiation
requires available connection IDs for the same path ID on both sides. For instance,
if the maximum path ID limit is 2 and the endpoint wants to provide connection IDs
for only one path ID inside range [1, 2], it should select path ID 1 (and not Path
ID 2).<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<p id="section-3.2.1-3">Similarly, endpoints SHOULD consume path IDs in a continuous way, i.e., when
creating paths. However, endpoints cannot expect to receive new connection IDs
or path initiation attempts with in-order use of path IDs
due to out-of-order delivery or path validation failure.<a href="#section-3.2.1-3" class="pilcrow">¶</a></p>
<p id="section-3.2.1-4">Each endpoint maintains the set of connection IDs received from its peer for each path,
any of which it can use when sending packets on that path; see also <span><a href="https://rfc-editor.org/rfc/rfc9000#section-5.1" class="relref">Section 5.1</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>.
Usually, it is desired to provide at least one additional connection ID for
all used paths, to allow for (unintentional) migration events (<span><a href="https://rfc-editor.org/rfc/rfc9000#section-9.5" class="relref">Section 9.5</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>).<a href="#section-3.2.1-4" class="pilcrow">¶</a></p>
<p id="section-3.2.1-5">As further specified in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-5.1" class="relref">Section 5.1</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> connection IDs
cannot be issued more than once on the same connection
and therefore are unique for the scope of the connection,
regardless of the associated path ID.<a href="#section-3.2.1-5" class="pilcrow">¶</a></p>
<p id="section-3.2.1-6">Endpoints MUST NOT issue new connection IDs with path IDs greater than
the Maximum Path Identifier field in MAX_PATH_ID frames (see <a href="#max-paths-frame" class="auto internal xref">Section 4.6</a>)
or the value of initial_max_path_id transport parameter if no MAX_PATH_ID frame was received yet.
Receipt of a frame with a greater path ID is a connection error as specified
in <a href="#frames" class="auto internal xref">Section 4</a>.<a href="#section-3.2.1-6" class="pilcrow">¶</a></p>
<p id="section-3.2.1-7">When an endpoint finds it has not enough available unused path IDs,
it SHOULD either send a MAX_PATH_ID frame to increase the active path limit
(when limited by the sender) or a PATHS_BLOCKED frame
(see <a href="#paths-and-cids-blocked-frame" class="auto internal xref">Section 4.7</a>) to inform the peer that
its current limit prevented the creation of the new path.<a href="#section-3.2.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rotating-and-retiring-connection-ids">
<section id="section-3.2.2">
          <h4 id="name-rotating-and-retiring-conne">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-rotating-and-retiring-conne" class="section-name selfRef">Rotating and Retiring Connection IDs</a>
          </h4>
<p id="section-3.2.2-1"><span><a href="https://rfc-editor.org/rfc/rfc9000#section-5.1.2" class="relref">Section 5.1.2</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> indicates that an endpoint
can change the connection ID it uses to another available one
at any time during the connection. For the extension specified in
this document, endpoints MUST only rotate to another connection IDs associated
to the same path ID. Use of a connection ID associated with
another path ID will be considered as an attempt to open a new path instead.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">An endpoint is supposed to retire connection ID that are not used anymore,
and the server is supposed to provide
replacements, as specified in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-5.1.2." class="relref">Section 5.1.2.</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>.
As such, when receiving a PATH_RETIRE_CONNECTION_ID frame, an endpoint
SHOULD provide new connection IDs for that path, if still open, using PATH_NEW_CONNECTION_ID frames.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2.2-3">While it it expected that the peer provides at least one unused connection ID
for all active paths using the PATH_NEW_CONNECTION_ID after retirement
of an old connection ID, an endpoint MAY send
a PATH_CIDS_BLOCKED (see <a href="#paths-and-cids-blocked-frame" class="auto internal xref">Section 4.7</a>)
if it wants to change the connection ID but no
unused connection ID for a that path is available. Further, an
endpoint MAY also send a PATH_CIDS_BLOCKED frame if it wants to
open a new path and has no connection IDs available for an unused
path ID even though the Maximum Path Identifier value would allow
for more paths.<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2.2-4">Retirement of connection IDs will not retire the path ID
that corresponds to the connection ID or any other path resources
as the packet number space is associated to the path ID.<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2.2-5">The peer that sends the PATH_RETIRE_CONNECTION_ID frame can keep sending data
on the path that the retired connection ID was used on but has
to use a different connection ID for the same path ID when doing so.<a href="#section-3.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="path-state">
<section id="section-3.3">
        <h3 id="name-path-status-management">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-path-status-management" class="section-name selfRef">Path Status Management</a>
        </h3>
<p id="section-3.3-1">An endpoint can send PATH_BACKUP and PATH_AVAILABLE frames (see
<a href="#path-backup-available-frame" class="auto internal xref">Section 4.3</a>) to inform the peer that it should
send packets on the paths with the preference expressed by these frames.
Note that an endpoint might not follow the peer’s advertisements,
but these frames are still a clear signal of the peer's preference of path usage.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">Each peer indicates its preference of path usage independently of the other peer.
That means that peers may have different usage preferences for the same path.
Depending on the data sender's decisions, this may lead to usage of paths that have been
indicated as "backup" by the peer or non-usage of some locally available paths.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">PATH_AVAILABLE indicates that a path is "available", i.e., it suggests to
the peer to use its own logic to split traffic among available paths.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">PATH_BACKUP suggests that a path should only be used as backup i.e. that no traffic
should be sent on that path if another path is available and usable.
If all established paths are indicated as backup paths, no guidance is provided about
which path should be used.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">Similarly, if no frame indicating a path usage preference was received for a certain path,
the preference of the peer is unknown and the sender needs to decide based on it
own local logic if the path should be used.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">If an endpoint starts using a backup path
because it has detected issues on the paths marked as "available", it is RECOMMENDED
to update its own path state signaling such that the peer avoids using the broken path.
An endpoint that detects a path breakage can also explicitly close the path
by sending a PATH_ABANDON frame (see <a href="#path-close" class="auto internal xref">Section 3.4</a>) in order to avoid
that its peer keeps using it and enable faster switchover to a backup path.
If the endpoints do not want to close the path immediately, as connectivity
could be re-established, PING frames can potentially be used to quickly detect
connectivity changes and switch back in a timely way.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7">The PATH_AVAILABLE and PATH_BACKUP frames share a common, per-path sequence number space
to detect and ignore outdated information, as further described in <a href="#path-backup-available-frame" class="auto internal xref">Section 4.3</a>.
This is needed as they might arrive out-of-order,
e.g., if sent using different paths.<a href="#section-3.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="path-close">
<section id="section-3.4">
        <h3 id="name-path-close">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-path-close" class="section-name selfRef">Path Close</a>
        </h3>
<p id="section-3.4-1">At any time in the connection, each endpoint can decide to
abandon a path, for example following changes in local
connectivity or local preferences.
An endpoint that wants to abandon a path MUST explicitly
close the path by sending a PATH_ABANDON frame (see <a href="#path-abandon-frame" class="auto internal xref">Section 4.2</a>).
This is true whether the decision to close the path results
from implicit signals such as an idle time-out (see <a href="#idle-time-close" class="auto internal xref">Section 5.9</a>)
or packet losses as well as for any other reason such as management
of local resources.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">The peers that send a PATH_ABANDON frame MUST treat all connection
IDs received from the peer for the path ID indicated in the PATH_ABANDON as immediately
retired, and subsequently cannot send any packet on that path anymore.
Note that while abandoning a path will cause
connection ID retirement, the inverse is not true: retiring the associated connection IDs
does not indicate path abandonment (see further <a href="#consume-retire-cid" class="auto internal xref">Section 3.2</a>).<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">PATH_ABANDON frames can be sent on any open path,
not only on the path that is intended to be closed.
It is RECOMMENDED to send the PATH_ABANDON frames on another open path,
especially if connectivity on the to-be-abandoned path
is expected to be broken.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">When an endpoint receives a PATH_ABANDON frame, it MUST send a corresponding
PATH_ABANDON frame, if it has not already done so, and respectively treat all
connection IDs received from the peer for that path as immediately
retired. While that means retired connection IDs received from the peer cannot be used
for sending anymore, packets from the peer might still be in transit.
Therefore, knowledge of the
connection IDs issued to the peer and of the state
of the number space associated to the path SHOULD be retained for
3 PTO after the PATH_ABANDON frame has been received.
This avoids generating spurious stateless packets, as discussed in
<a href="#spurious-stateless-reset" class="auto internal xref">Section 3.4.2</a>, and helps acknowledge any
potentially reordered, outstanding packets from the peer (see <a href="#ack-after-abandon" class="auto internal xref">Section 3.4.3</a>).<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">It is also possible that an endpoint will receive a PATH_ABANDON frame
before receiving or sending any traffic on a path. For example, if the client
tries to initiate a path and the path cannot be established, it will send a
PATH_ABANDON frame (see <a href="#path-initiation" class="auto internal xref">Section 3.1</a>). An endpoint may also decide
to abandon an unused path for any other reason, for example, removing a hole from
the sequence of path IDs in use. This is not an error.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<p id="section-3.4-6">If a peer sends a PATH_ABANDON frame but never receives
a corresponding PATH_ABANDON frame, it might not be able to remove path state.
It is left to the implementation to handle this unexpected
behavior as it does not impact interoperability. If the endpoint is no longer
willing to process the issued connection IDs for the abandoned path,
it MAY close the connection, but SHOULD wait at least 3 PTOs after
sending the PATH_ABANDON frame.<a href="#section-3.4-6" class="pilcrow">¶</a></p>
<p id="section-3.4-7">After a path is abandoned, the path ID MUST NOT be reused
for new paths, as the path ID is part of the nonce calculation <a href="#nonce" class="auto internal xref">Section 2.4</a>.<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<p id="section-3.4-8">If a PATH_ABANDON frame is received for the only open path of a QUIC
connection, the receiving peer SHOULD send a CONNECTION_CLOSE frame
and enter the closing state. Alternatively, a client MAY instead try to open a new path, if
available, and only initiate connection closure if path validation fails
or a CONNECTION_CLOSE frame is received from the server. Similarly,
the server MAY wait for a short, limited time such as one PTO if a path
probing packet is received on a new path before sending the
CONNECTION_CLOSE frame.<a href="#section-3.4-8" class="pilcrow">¶</a></p>
<p id="section-3.4-9">Note that other explicit closing mechanisms of <span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> still
apply on the whole connection. In particular, the reception of either a
CONNECTION_CLOSE (<span><a href="https://rfc-editor.org/rfc/rfc9000#section-10.2" class="relref">Section 10.2</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>) or a Stateless
Reset (<span><a href="https://rfc-editor.org/rfc/rfc9000#section-10.3" class="relref">Section 10.3</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>) closes the connection.<a href="#section-3.4-9" class="pilcrow">¶</a></p>
<div id="path-closure-example">
<section id="section-3.4.1">
          <h4 id="name-path-closure-example">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-path-closure-example" class="section-name selfRef">Path Closure Example</a>
          </h4>
<p id="section-3.4.1-1">In the example below, the client wants to close the path with path ID 0.
It sends the PATH_ABANDON frame to terminate the path with path ID 0
on the path with path ID 1 using the connection ID S1. After receiving
the PATH_ABANDON frame for path ID 0, the server also sends a
PATH_ABANDON frame with path ID 0 together with an PATH_ACK frame
on the same path using connection ID C1.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<span id="name-example-of-closing-a-path"></span><div id="fig-example-path-close1">
<figure id="figure-2">
            <div class="alignLeft art-text artwork" id="section-3.4.1-2.1">
<pre>
Client                                                      Server

(client tells server to abandon a path with path ID 0)
1-RTT[X]: DCID=S1 PATH_ABANDON[path ID=0]-&gt;
                           (server tells client to abandon a path)
                    &lt;-1-RTT[Y]: DCID=C1 PATH_ABANDON[path ID=0],
                                           PATH_ACK[PATH ID=1, PN=X]
1-RTT[U]: DCID=S1 PATH_ACK[path ID=1, PN=Y] -&gt;
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-example-of-closing-a-path" class="selfRef">Example of closing a path.</a>
            </figcaption></figure>
</div>
<p id="section-3.4.1-3">Note that if the PATH_ABANDON frame is instead sent on the to-be-abandoned path,
the last acknowledgment still needs to be send on a different path
as no further packets can be sent on the abandoned path after the
PATH_ABANDON frame.<a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="spurious-stateless-reset">
<section id="section-3.4.2">
          <h4 id="name-avoiding-spurious-stateless">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-avoiding-spurious-stateless" class="section-name selfRef">Avoiding Spurious Stateless Resets</a>
          </h4>
<p id="section-3.4.2-1">Due to network delays, packets sent on an abandoned path can
arrive well after the connection IDs have been retired.
If not recognized as bound to the local
connection, such packet triggers the peer to send a Stateless Reset
packet. The rule to "retain knowledge of connection ID for 3 PTO
after receiving a PATH_ABANDON"
is intended to reduce the risk of sending such spurious stateless
packets, but it cannot completely avoid that risk.<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2-2"><span><a href="https://rfc-editor.org/rfc/rfc9000#section-10.3" class="relref">Section 10.3</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> specified that the Stateless Reset Tokens
associated with retired connection IDs cannot be used to identify Stateless Reset packets.
The immediate retirement of connection IDs received from the peer for an abandoned
path guarantees that spurious Stateless Reset packets
sent by the peer will not cause the closure of the QUIC connection.<a href="#section-3.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ack-after-abandon">
<section id="section-3.4.3">
          <h4 id="name-handling-path_ack-for-aband">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-handling-path_ack-for-aband" class="section-name selfRef">Handling PATH_ACK for Abandoned Paths</a>
          </h4>
<p id="section-3.4.3-1">When an endpoint sends a PATH_ABANDON frame, there may
still be some packets in transit from the peer.
Further, if an endpoint receives a PATH_ABANDON frame, it may still receive
reordered packets on the abandoned path. Endpoints SHOULD
promptly send PATH_ACK frames for all unacknowledged packets received on
an abandoned path if path state is still retained to do so.<a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
<p id="section-3.4.3-2">PATH_ACK frames have to be sent on a different path than the path being abandoned
after sending the PATH_ABANDON frame as connection IDs are immediately retired.<a href="#section-3.4.3-2" class="pilcrow">¶</a></p>
<p id="section-3.4.3-3">When an endpoint finally deletes all state associated with the path,
the packets sent over the path and not yet acknowledged MUST be considered lost.
PATH_ACK frames received with an abandoned path ID are silently ignored,
as specified in <a href="#frames" class="auto internal xref">Section 4</a>.<a href="#section-3.4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="frames">
<section id="section-4">
      <h2 id="name-new-frames">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-new-frames" class="section-name selfRef">New Frames</a>
      </h2>
<p id="section-4-1">All frames defined in this document MUST only be sent in 1-RTT packets.
If an endpoint receives a multipath-specific frame in a different packet type,
it MUST close the connection with an error of type PROTOCOL_VIOLATION.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Receipt of multipath-specific frames
that use a path ID that is greater than the announced Maximum Paths value
in the MAX_PATH_ID frame or in the initial_max_path_id transport parameter,
if no MAX_PATH_ID frame was received yet,
MUST be treated as a connection error of type PROTOCOL_VIOLATION.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">If an endpoint receives a multipath-specific frame
with a path ID that it cannot process
anymore (e.g., because the path might have been abandoned), it
MUST silently ignore the frame.<a href="#section-4-3" class="pilcrow">¶</a></p>
<div id="mp-ack-frame">
<section id="section-4.1">
        <h3 id="name-path_ack-frame">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-path_ack-frame" class="section-name selfRef">PATH_ACK Frame</a>
        </h3>
<p id="section-4.1-1">The PATH_ACK frame (types TBD-00 and TBD-01)
is an extension of the ACK frame specified in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-19.3" class="relref">Section 19.3</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>. It is
used to acknowledge packets that were sent on different paths, as
each path has its own packet number space. If the frame type is TBD-01, PATH_ACK frames
also contain the sum of QUIC packets with associated ECN marks received
on the acknowledged packet number space up to this point.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">PATH_ACK frame is formatted as shown in <a href="#fig-mp-ack-format" class="auto internal xref">Figure 3</a>.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<span id="name-path_ack-frame-format"></span><div id="fig-mp-ack-format">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-4.1-3.1">
<pre>
  PATH_ACK Frame {
    Type (i) = TBD-00..TBD-01
         (experiments use  0x15228c00-0x15228c01),
    Path Identifier (i),
    Largest Acknowledged (i),
    ACK Delay (i),
    ACK Range Count (i),
    First ACK Range (i),
    ACK Range (..) ...,
    [ECN Counts (..)],
  }
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-path_ack-frame-format" class="selfRef">PATH_ACK Frame Format</a>
          </figcaption></figure>
</div>
<p id="section-4.1-4">Compared to the ACK frame specified in <span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>, the following
field is added:<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-5">
          <dt id="section-4.1-5.1">Path Identifier:</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.2">
            <p id="section-4.1-5.2.1">The path ID associated with the packet number space of the 0-RTT and 1-RTT packets
which are acknowledged by the PATH_ACK frame.<a href="#section-4.1-5.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="path-abandon-frame">
<section id="section-4.2">
        <h3 id="name-path_abandon-frame">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-path_abandon-frame" class="section-name selfRef">PATH_ABANDON Frame</a>
        </h3>
<p id="section-4.2-1">The PATH_ABANDON frame informs the peer to abandon a path.
After the PATH_ABANDON frame is sent on a path, the path can no longer be used for sending.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">PATH_ABANDON frames are formatted as shown in <a href="#fig-path-abandon-format" class="auto internal xref">Figure 4</a>.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<span id="name-path_abandon-frame-format"></span><div id="fig-path-abandon-format">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-4.2-3.1">
<pre>
  PATH_ABANDON Frame {
    Type (i) = TBD-02 (experiments use 0x15228c05),
    Path Identifier (i),
    Error Code (i),
  }
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-path_abandon-frame-format" class="selfRef">PATH_ABANDON Frame Format</a>
          </figcaption></figure>
</div>
<p id="section-4.2-4">PATH_ABANDON frames contain the following fields:<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-5">
          <dt id="section-4.2-5.1">Path Identifier:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-5.2">
            <p id="section-4.2-5.2.1">The path ID associated to the to-be-abandoned path.<a href="#section-4.2-5.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-5.3">Error Code:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-5.4">
            <p id="section-4.2-5.4.1">A variable-length integer that indicates the reason for abandoning
this path. NO_ERROR(0x0) indicates that the path is being abandoned
without any error being encountered. Other error codes can be found in <a href="#error-codes" class="auto internal xref">Section 4.2.1</a>.<a href="#section-4.2-5.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-6">PATH_ABANDON frames are ack-eliciting. If a packet containing
a PATH_ABANDON frame is considered lost, the peer SHOULD repeat it.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">Use of the PATH_ABANDON frame is specified in section <a href="#path-close" class="auto internal xref">Section 3.4</a>.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<div id="error-codes">
<section id="section-4.2.1">
          <h4 id="name-error-codes">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-error-codes" class="section-name selfRef">Error Codes</a>
          </h4>
<p id="section-4.2.1-1">QUIC transport error codes are 62-bit unsigned integers
(see <span><a href="https://rfc-editor.org/rfc/rfc9000#section-20.1" class="relref">Section 20.1</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>. In addition to
NO_ERROR(0x0), the following QUIC error codes are defined
for use in the PATH_ABANDON frame:<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.1-2">
            <dt id="section-4.2.1-2.1">APPLICATION_ABANDON (TBD-10):</dt>
            <dd style="margin-left: 1.5em" id="section-4.2.1-2.2">
              <p id="section-4.2.1-2.2.1">The endpoint is abandoning the path at the
request of the application.<a href="#section-4.2.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.1-2.3">RESOURCE_LIMIT_REACHED (TBD-11):</dt>
            <dd style="margin-left: 1.5em" id="section-4.2.1-2.4">
              <p id="section-4.2.1-2.4.1">The endpoint is abandoning the path because
it cannot allocate sufficient resources to maintain it.<a href="#section-4.2.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.1-2.5">UNSTABLE_INTERFACE (TBD-12):</dt>
            <dd style="margin-left: 1.5em" id="section-4.2.1-2.6">
              <p id="section-4.2.1-2.6.1">The endpoint is abandoning the path because
the used interface is considered to be unstable. This condition can occur, e.g.,
due to a weak wireless signal or frequent handover events during high-speed mobility.<a href="#section-4.2.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.1-2.7">NO_CID_AVAILABLE (TBD-13):</dt>
            <dd style="margin-left: 1.5em" id="section-4.2.1-2.8">
              <p id="section-4.2.1-2.8.1">The endpoint is abandoning the path due to
the lack of a connection ID for this path.
This may occur when the peer initiates a new path
but has not provided a corresponding connection ID for the path ID
(or the packet containing the connection IDs has not arrived yet).<a href="#section-4.2.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="path-backup-available-frame">
<section id="section-4.3">
        <h3 id="name-path_available-and-path_bac">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-path_available-and-path_bac" class="section-name selfRef">PATH_AVAILABLE and PATH_BACKUP frames</a>
        </h3>
<p id="section-4.3-1">PATH_AVAILABLE frames are used by endpoints to inform the peer
that the indicated path is available for sending.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">PATH_AVAILABLE frames are formatted as shown in <a href="#fig-path-available-format" class="auto internal xref">Figure 5</a>.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<span id="name-path_available-frame-format"></span><div id="fig-path-available-format">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-4.3-3.1">
<pre>
  PATH_AVAILABLE Frame {
    Type (i) = TBD-04 (experiments use 0x15228c08),
    Path Identifier (i),
    Path Status Sequence Number (i),
  }
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-path_available-frame-format" class="selfRef">PATH_AVAILABLE Frame Format</a>
          </figcaption></figure>
</div>
<p id="section-4.3-4">PATH_BACKUP frames are used by endpoints to inform the peer
about its preference to not use the indicated path for sending.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">PATH_BACKUP frames are formatted as shown in <a href="#fig-path-backup-format" class="auto internal xref">Figure 6</a>.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<span id="name-path_backup-frame-format"></span><div id="fig-path-backup-format">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-4.3-6.1">
<pre>
  PATH_BACKUP Frame {
    Type (i) = TBD-03 (experiments use 0x15228c07)
    Path Identifier (i),
    Path Status Sequence Number (i),
  }
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-path_backup-frame-format" class="selfRef">PATH_BACKUP Frame Format</a>
          </figcaption></figure>
</div>
<p id="section-4.3-7">Both PATH_AVAILABLE and PATH_BACKUP frames contain the following fields:<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3-8">
          <dt id="section-4.3-8.1">Path Identifier:</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-8.2">
            <p id="section-4.3-8.2.1">The path ID that the status update corresponds to.
All path IDs below the maximum path ID limit can be indicated,
even if the path is not in active use yet.<a href="#section-4.3-8.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-8.3">Path Status Sequence Number:</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-8.4">
            <p id="section-4.3-8.4.1">A variable-length integer specifying the per-path sequence number assigned for
this frame.<a href="#section-4.3-8.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-9">The sequence number space is common to the two frame types,
and monotonically increasing values MUST be used when sending PATH_AVAILABLE or
PATH_BACKUP frames for a given path ID.<a href="#section-4.3-9" class="pilcrow">¶</a></p>
<p id="section-4.3-10">Frames may be received out of order. A peer MUST ignore an incoming
PATH_AVAILABLE or
PATH_BACKUP frame if it previously received another PATH_BACKUP frame
or PATH_AVAILABLE frame for the same path ID with a Path Status sequence number
equal to or higher than the Path Status sequence number of the incoming frame.<a href="#section-4.3-10" class="pilcrow">¶</a></p>
<p id="section-4.3-11">The requirement of monotonically increasing sequence numbers
is per path. Receivers could very well receive the
same sequence number for PATH_AVAILABLE or PATH_BACKUP Frames
on different paths. As such, the receiver of
the PATH_AVAILABLE or PATH_BACKUP frame needs to use and compare the sequence numbers
separately for each path ID.<a href="#section-4.3-11" class="pilcrow">¶</a></p>
<p id="section-4.3-12">PATH_BACKUP and PATH_AVAILABLE frames are ack-eliciting. If a packet containing a
PATH_BACKUP or PATH_AVAILABLE frame is considered lost, the peer SHOULD resend the frame
only if it contains the last status sent for that path -- as indicated
by the sequence number.<a href="#section-4.3-12" class="pilcrow">¶</a></p>
<p id="section-4.3-13">A PATH_BACKUP or a PATH_AVAILABLE frame MAY be bundled with a PATH_NEW_CONNECTION_ID frame or
a PATH_RESPONSE frame in order to indicate the preferred path usage
before or during path initiation.<a href="#section-4.3-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mp-new-conn-id-frame">
<section id="section-4.4">
        <h3 id="name-path_new_connection_id-fram">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-path_new_connection_id-fram" class="section-name selfRef">PATH_NEW_CONNECTION_ID frame</a>
        </h3>
<p id="section-4.4-1">The PATH_NEW_CONNECTION_ID frame (type=TBD-05)
is an extension of the NEW_CONNECTION_ID frame specified in
<span><a href="https://rfc-editor.org/rfc/rfc9000#section-19.15" class="relref">Section 19.15</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>.
It is used to provide its peer with alternative connection IDs for 1-RTT packets
for a specific path. The peer can then use a different connection ID on the same path
to break linkability when migrating on that path; see also <span><a href="https://rfc-editor.org/rfc/rfc9000#section-9.5" class="relref">Section 9.5</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">PATH_NEW_CONNECTION_ID frames are formatted as shown in <a href="#fig-mp-connection-id-frame-format" class="auto internal xref">Figure 7</a>.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<span id="name-path_new_connection_id-frame"></span><div id="fig-mp-connection-id-frame-format">
<figure id="figure-7">
          <div class="alignLeft art-text artwork" id="section-4.4-3.1">
<pre>
PATH_NEW_CONNECTION_ID Frame {
  Type (i) = TBD-05 (experiments use 0x15228c09),
  Path Identifier (i),
  Sequence Number (i),
  Retire Prior To (i),
  Length (8),
  Connection ID (8..160),
  Stateless Reset Token (128),
}
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-path_new_connection_id-frame" class="selfRef">PATH_NEW_CONNECTION_ID Frame Format</a>
          </figcaption></figure>
</div>
<p id="section-4.4-4">Compared to the NEW_CONNECTION_ID frame specified in
<span><a href="https://rfc-editor.org/rfc/rfc9000#section-19.15" class="relref">Section 19.15</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>, the following
field is added:<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4-5">
          <dt id="section-4.4-5.1">Path Identifier:</dt>
          <dd style="margin-left: 1.5em" id="section-4.4-5.2">
            <p id="section-4.4-5.2.1">The path ID associated with the connection ID. This
means the provided connection ID can only be used on the corresponding path.<a href="#section-4.4-5.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.4-6">Note that, other than for the NEW_CONNECTION_ID frame of <span><a href="https://rfc-editor.org/rfc/rfc9000#section-19.15" class="relref">Section 19.15</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>,
the sequence number applies on a per-path context.
This means different connection IDs on different paths may have the same
sequence number value.<a href="#section-4.4-6" class="pilcrow">¶</a></p>
<p id="section-4.4-7">The Retire Prior To field indicates which connection IDs
should be retired among those that share the path ID in the Path Identifier field.
Connection IDs associated with different path IDs are not affected.<a href="#section-4.4-7" class="pilcrow">¶</a></p>
<p id="section-4.4-8">Note that the NEW_CONNECTION_ID frame can only be used to issue or retire
connection IDs for the initial path with path ID 0.<a href="#section-4.4-8" class="pilcrow">¶</a></p>
<p id="section-4.4-9">The last paragraph of <span><a href="https://rfc-editor.org/rfc/rfc9000#section-5.1.2" class="relref">Section 5.1.2</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> specifies how to
verify the Retire Prior To field of an incoming NEW_CONNECTION_ID frame.
The same rule
applies for PATH_NEW_CONNECTION_ID frames, but it applies per path. If the
multipath extension is used, the rule
for NEW_CONNECTION_ID frame is only applied for path ID 0.<a href="#section-4.4-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mp-retire-conn-id-frame">
<section id="section-4.5">
        <h3 id="name-path_retire_connection_id-f">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-path_retire_connection_id-f" class="section-name selfRef">PATH_RETIRE_CONNECTION_ID frame</a>
        </h3>
<p id="section-4.5-1">The PATH_RETIRE_CONNECTION_ID frame (TBD-06)
is an extension of the RETIRE_CONNECTION_ID frame specified in
<span><a href="https://rfc-editor.org/rfc/rfc9000#section-19.16" class="relref">Section 19.16</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>. It is used
to indicate that an endpoint will no longer use a connection ID for a specific path ID
that was issued by its peer. To retire the connection ID used
during the handshake on the initial path, path ID 0 is used.
Sending a PATH_RETIRE_CONNECTION_ID frame also serves as a request to the peer
to send additional connection IDs for this path (see also <span><a href="https://rfc-editor.org/rfc/rfc9000#section-5.1" class="relref">Section 5.1</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>),
unless the path specified by the path ID has been abandoned. New path-specific connection IDs can be
delivered to a peer using the PATH_NEW_CONNECTION_ID frame (see <a href="#mp-new-conn-id-frame" class="auto internal xref">Section 4.4</a>).<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">PATH_RETIRE_CONNECTION_ID frames are formatted as shown in <a href="#fig-mp-retire-connection-id-frame-format" class="auto internal xref">Figure 8</a>.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<span id="name-path_retire_connection_id-fr"></span><div id="fig-mp-retire-connection-id-frame-format">
<figure id="figure-8">
          <div class="alignLeft art-text artwork" id="section-4.5-3.1">
<pre>
PATH_RETIRE_CONNECTION_ID Frame {
  Type (i) = TBD-06 (experiments use 0x15228c0a),
  Path Identifier (i),
  Sequence Number (i),
}
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-path_retire_connection_id-fr" class="selfRef">PATH_RETIRE_CONNECTION_ID Frame Format</a>
          </figcaption></figure>
</div>
<p id="section-4.5-4">Compared to the RETIRE_CONNECTION_ID frame specified in
<span><a href="https://rfc-editor.org/rfc/rfc9000#section-19.16" class="relref">Section 19.16</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>, the following
field is added:<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5-5">
          <dt id="section-4.5-5.1">Path Identifier:</dt>
          <dd style="margin-left: 1.5em" id="section-4.5-5.2">
            <p id="section-4.5-5.2.1">The path ID associated with the connection ID to retire.<a href="#section-4.5-5.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.5-6">Note that the RETIRE_CONNECTION_ID frame can only be used to retire
connection IDs for the initial path with path ID 0.<a href="#section-4.5-6" class="pilcrow">¶</a></p>
<p id="section-4.5-7">As the PATH_NEW_CONNECTION_ID frames applies the sequence number per path,
the sequence number in the PATH_RETIRE_CONNECTION_ID frame is also per
path. The PATH_RETIRE_CONNECTION_ID frame retires the Connection ID with
the specified path ID and sequence number.<a href="#section-4.5-7" class="pilcrow">¶</a></p>
<p id="section-4.5-8">The processing of an incoming RETIRE_CONNECTION_ID frame
is described in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-19.16" class="relref">Section 19.16</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>. The same processing
applies for PATH_RETIRE_CONNECTION_ID frames per path, while with use of
the multipath extension the
processing of a RETIRE_CONNECTION_ID frame is only applied for path ID 0.<a href="#section-4.5-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="max-paths-frame">
<section id="section-4.6">
        <h3 id="name-max_path_id-frame">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-max_path_id-frame" class="section-name selfRef">MAX_PATH_ID frame</a>
        </h3>
<p id="section-4.6-1">A MAX_PATH_ID frame (type=0x15228c0c) informs the peer of the maximum path ID
it is permitted to use.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">MAX_PATH_ID frames are formatted as shown in <a href="#fig-max-paths-frame-format" class="auto internal xref">Figure 9</a>.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<span id="name-max_path_id-frame-format"></span><div id="fig-max-paths-frame-format">
<figure id="figure-9">
          <div class="alignLeft art-text artwork" id="section-4.6-3.1">
<pre>
MAX_PATH_ID Frame {
  Type (i) = TBD-07 (experiments use 0x15228c0c),
  Maximum Path Identifier (i),
}
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-max_path_id-frame-format" class="selfRef">MAX_PATH_ID Frame Format</a>
          </figcaption></figure>
</div>
<p id="section-4.6-4">MAX_PATH_ID frames contain the following field:<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.6-5">
          <dt id="section-4.6-5.1">Maximum Path Identifier:</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-5.2">
            <p id="section-4.6-5.2.1">The maximum path ID that the sending endpoint is willing to accept.
This value MUST NOT exceed 2^32-1, which is the maximum allowed value for the path ID due to
restrictions on the nonce calculation (see <a href="#nonce" class="auto internal xref">Section 2.4</a>).
The Maximum Path Identifier value MUST NOT be lower than the value
advertised in the initial_max_path_id transport parameter.<a href="#section-4.6-5.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.6-6">Receipt of an invalid Maximum Path Identifier value MUST be treated as a
connection error of type PROTOCOL_VIOLATION.<a href="#section-4.6-6" class="pilcrow">¶</a></p>
<p id="section-4.6-7">Loss or reordering can cause an endpoint to receive a MAX_PATH_ID frame with
a smaller Maximum Path Identifier value than was previously received.
MAX_PATH_ID frames that do not increase the path limit MUST be ignored.<a href="#section-4.6-7" class="pilcrow">¶</a></p>
<p id="section-4.6-8">MAX_PATH_ID frames are ack-eliciting and SHOULD be retransmitted when lost
and no more recent MAX_PATH_ID frame has been sent in the meantime.<a href="#section-4.6-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="paths-and-cids-blocked-frame">
<section id="section-4.7">
        <h3 id="name-paths_blocked-and-path_cids">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-paths_blocked-and-path_cids" class="section-name selfRef">PATHS_BLOCKED and PATH_CIDS_BLOCKED frames</a>
        </h3>
<p id="section-4.7-1">A sender can send a PATHS_BLOCKED frame (type=0x15228c0d) when
it wishes to open a path but is unable to do so due to the maximum path ID
limit set by its peer.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">A sender can send a PATH_CIDS_BLOCKED frame (type=0x15228c0e) when
it wishes to open a path with a valid path ID or change the CID on an established path
but is unable to do so because there are no unused connection IDs available
for the corresponding path ID.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">Note that PATHS_BLOCKED and PATH_CIDS_BLOCKED frames are informational.
Sending a PATHS_BLOCKED or a PATH_CIDS_BLOCKED frame does not imply a particular action from the peer
like sending a MAX_PATH_ID farme with a new Maximum Path Identifier value,
but informs the peer that the maximum path ID limit
or the absence of unused connection IDs prevented the creation or the usage of paths.
If the successful reception of a PATHS_BLOCKED/PATH_CIDS_BLOCKED frame was acknowledged but
no action is taken by the peer, this is likely a deliberate decision by the peer and
repeating the PATHS_BLOCKED/PATH_CIDS_BLOCKED frame will not change that.<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<p id="section-4.7-4">PATHS_BLOCKED frames are formatted as shown in <a href="#fig-paths-blocked-frame-format" class="auto internal xref">Figure 10</a>.<a href="#section-4.7-4" class="pilcrow">¶</a></p>
<span id="name-max_path_id_blocked-frame-f"></span><div id="fig-paths-blocked-frame-format">
<figure id="figure-10">
          <div class="alignLeft art-text artwork" id="section-4.7-5.1">
<pre>
PATHS_BLOCKED Frame {
  Type (i) = TBD-08 (experiments use 0x15228c0d),
  Maximum Path Identifier (i),
}
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-max_path_id_blocked-frame-f" class="selfRef">MAX_PATH_ID_BLOCKED Frame Format</a>
          </figcaption></figure>
</div>
<p id="section-4.7-6">PATHS_BLOCKED frames contain the following field:<a href="#section-4.7-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.7-7">
          <dt id="section-4.7-7.1">Maximum Path Identifier:</dt>
          <dd style="margin-left: 1.5em" id="section-4.7-7.2">
            <p id="section-4.7-7.2.1">A variable-length integer indicating the maximum path ID that was
allowed at the time the frame was sent. If the received value is lower than
the currently allowed maximum value, this frame can be ignored.<a href="#section-4.7-7.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.7-8">PATH_CIDS_BLOCKED frames are formatted as shown in <a href="#fig-path-cid-blocked-frame-format" class="auto internal xref">Figure 11</a>.<a href="#section-4.7-8" class="pilcrow">¶</a></p>
<span id="name-path_cids_blocked-frame-for"></span><div id="fig-path-cid-blocked-frame-format">
<figure id="figure-11">
          <div class="alignLeft art-text artwork" id="section-4.7-9.1">
<pre>
PATH_CIDS_BLOCKED Frame {
  Type (i) = TBD-09 (experiments use 0x15228c0e),
  Path Identifier (i),
  Next Sequence Number (i),
}
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-path_cids_blocked-frame-for" class="selfRef">PATH_CIDS_BLOCKED Frame Format</a>
          </figcaption></figure>
</div>
<p id="section-4.7-10">PATH_CIDS_BLOCKED frames contain the following fields:<a href="#section-4.7-10" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.7-11">
          <dt id="section-4.7-11.1">Path Identifier:</dt>
          <dd style="margin-left: 1.5em" id="section-4.7-11.2">
            <p id="section-4.7-11.2.1">Identifier of the path for which unused connection IDs are not available.<a href="#section-4.7-11.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.7-11.3">Next Sequence Number:</dt>
          <dd style="margin-left: 1.5em" id="section-4.7-11.4">
            <p id="section-4.7-11.4.1">The next sequence number that is expected to be issued for a connection ID for this path by the peer.<a href="#section-4.7-11.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.7-12">Receipt of a value of Maximum Path Identifier or Path Identifier that is higher than
the local maximum value MUST be treated as a connection error of type PROTOCOL_VIOLATION.<a href="#section-4.7-12" class="pilcrow">¶</a></p>
<p id="section-4.7-13">Receipt of a value of Next Sequence Number that is higher than
the sequence number of the next expected to be issued connection ID for this path
MUST be treated as a connection error of type PROTOCOL_VIOLATION.<a href="#section-4.7-13" class="pilcrow">¶</a></p>
<p id="section-4.7-14">PATHS_BLOCKED and PATH_CIDS_BLOCKED frames are ack-eliciting and MAY be retransmitted
if the path is still blocked when the lost is detected.<a href="#section-4.7-14" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="impl-consideration">
<section id="section-5">
      <h2 id="name-implementation-consideratio">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<p id="section-5-1">This section provides informational guidance for implementors.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="migration">
<section id="section-5.1">
        <h3 id="name-cid-changes-migration-and-n">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-cid-changes-migration-and-n" class="section-name selfRef">CID Changes, Migration, and NAT Rebindings</a>
        </h3>
<p id="section-5.1-1">With the multipath extension, each
path uses a separate packet number space.
This is a major difference from
<span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>, which only defines three number spaces (Initial,
Handshake and Application packets).<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">For any given path, connection ID rotation, NAT rebinding, or client initiated migration
as specified in <span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> might occur, like on a single path.
These events do not change the path ID,<br> and do not affect the packet number
space associated with the path.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">It is generally preferable to use multipath mechanisms such as
creating a new path and later abandoning the old path,
rather than doing migration of a single path as specified in <span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>.
This enables a smoother handover and allows a more controlled migration handling
at the server side. However, migration of a single path cannot be
avoided in case of NAT rebinding, or if the server requests migration
to a "preferred address" during the handshake.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4"><span><a href="https://rfc-editor.org/rfc/rfc9000#section-9.3" class="relref">Section 9.3</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> allows an endpoint to skip validation of
a peer address if that address has been seen recently. However, when the
multipath extension is used and an endpoint has multiple addresses that
could lead to switching between different paths, it should rather maintain
multiple open paths instead.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">Servers observing a 4-tuple change will
perform path validation (see <span><a href="https://rfc-editor.org/rfc/rfc9000#section-9" class="relref">Section 9</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>).
If path validation process succeeds, the endpoints set
the path's congestion controller and round-trip time
estimator according to <span><a href="https://rfc-editor.org/rfc/rfc9000#section-9.4" class="relref">Section 9.4</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="using-multiple-paths-on-the-same-4-tuple">
<section id="section-5.2">
        <h3 id="name-using-multiple-paths-on-the">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-using-multiple-paths-on-the" class="section-name selfRef">Using Multiple Paths on the Same 4-tuple</a>
        </h3>
<p id="section-5.2-1">It is possible to create paths that
refer to the same 4-tuple. For example, the endpoints may want
to create paths that use different Differentiated Service <span>[<a href="#RFC2475" class="cite xref">RFC2475</a>]</span> markings.
This could be done in conjunction with scheduling algorithms
that match streams to paths, so that for example data frames for
low priority streams are sent over low priority paths.
Since these paths use different path IDs, they can be managed
independently to suit the needs of the application.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">There may be cases in which paths are created with different 4-tuples,
but end up using the same 4-tuples as a consequence of path
migrations. Consider the following example where all paths use the same
source and destination ports:<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-3.1">
            <p id="section-5.2-3.1.1">Client starts path 1 from address 192.0.2.1 to server address 198.51.100.1<a href="#section-5.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-3.2">
            <p id="section-5.2-3.2.1">Client starts path 2 from address 192.0.2.2 to server address 198.51.100.1<a href="#section-5.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-3.3">
            <p id="section-5.2-3.3.1">Both paths are used for a while.<a href="#section-5.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-3.4">
            <p id="section-5.2-3.4.1">Server sends packet from address 198.51.100.1 to client address 192.0.2.1, with CID indicating path ID 2.<a href="#section-5.2-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-3.5">
            <p id="section-5.2-3.5.1">Client receives the packet, recognizes a path migration, updates the source address of path 2 to 192.0.2.1.<a href="#section-5.2-3.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.2-4">Such unintentional use of the same 4-tuple on different paths ought to
be rare. When they happen, the two paths would be redundant, and the
endpoint could want to close one of them.
Uncoordinated abandon of both endpoints may result in deleting
both paths instead of just one. To avoid this pitfall, endpoints could
adopt a simple coordination rule, such as only letting the client
initiate closure of duplicate paths, or perhaps relying on
the application protocol to decide which paths should be closed.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="congestion-control">
<section id="section-5.3">
        <h3 id="name-congestion-control">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-congestion-control" class="section-name selfRef">Congestion Control</a>
        </h3>
<p id="section-5.3-1">When the QUIC multipath extension is used, senders manage per-path
congestion status as required in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-9.4" class="relref">Section 9.4</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>.
However, in <span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> only one active path is assumed and as such
the requirement is to reset the congestion control status on path migration.
With the multipath extension, multiple paths can be used simultaneously,
therefore separate congestion control state is maintained for each path.
This means a sender is not allowed to send more data on a given path
than congestion control for that path indicates.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">When a Multipath QUIC connection uses two or more paths, there is no
guarantee that these paths are fully disjoint. When two (or more paths)
share the same bottleneck, using a standard congestion control scheme
could result in an unfair distribution of the bandwidth with
the multipath connection getting more bandwidth than competing single
paths connections. Multipath TCP uses the linked increased algorithm (LIA)
congestion control scheme
specified in <span>[<a href="#RFC6356" class="cite xref">RFC6356</a>]</span> to solve this problem.  This scheme can
immediately be adapted to Multipath QUIC. Other coupled congestion
control schemes have been proposed for Multipath TCP such as <span>[<a href="#OLIA" class="cite xref">OLIA</a>]</span>.
Designers of congestion control algorithms specialized for Multipath QUIC
are advised to follow BCP 133; see <span><a href="https://rfc-editor.org/rfc/rfc9743#section-7.10" class="relref">Section 7.10</a> of [<a href="#RFC9743" class="cite xref">RFC9743</a>]</span>.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3"><span><a href="https://rfc-editor.org/rfc/rfc9000#section-5.1.2" class="relref">Section 5.1.2</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> indicates that an endpoint
can change the connection ID it uses to another available one
at any time during the connection. As such, a sole change of the Connection
ID without any change in the address does not indicate a path change and
the endpoint can keep the same congestion control and RTT measurement state.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compute-rtt">
<section id="section-5.4">
        <h3 id="name-computing-path-rtt">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-computing-path-rtt" class="section-name selfRef">Computing Path RTT</a>
        </h3>
<p id="section-5.4-1">PATH_ACK frames indicate which path the acknowledged packets were sent on,
but they may be received through any open path. If successive acknowledgments are received
on different paths, the measured RTT samples can fluctuate widely,
which could result in poor performance depending e.g. on the used connection control.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">Congestion control state as defined in <span>[<a href="#QUIC-RECOVERY" class="cite xref">QUIC-RECOVERY</a>]</span> is kept
per path ID. However, depending on which path acknowledgements are
sent, the actual RTT of a path cannot be calculated or may not be
the right value to be used.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">Instead of using RTT, we define the acknowledgment delays as
the sum of two one-way delays: the delay
on the packet sending path and the delay on the return path chosen
for the acknowledgments.  When different paths have different
characteristics, acknowledgment delays can vary
widely. Consider for example a multipath transmission using both a
terrestrial path, with a latency of 50ms in each direction, and a
geostationary satellite path, with a latency of 300ms in each
direction.  The acknowledgment delay will depend on the combination
of paths used for the packet transmission and the acknowledgement transmission,
as shown in <a href="#fig-example-ack-delay" class="auto internal xref">Table 1</a>.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<span id="name-example-of-ack-delays-using"></span><div id="fig-example-ack-delay">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-example-of-ack-delays-using" class="selfRef">Example of ACK delays using multiple paths</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">ACK Path \ Data path</th>
              <th class="text-left" rowspan="1" colspan="1">Terrestrial</th>
              <th class="text-left" rowspan="1" colspan="1">Satellite</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Terrestrial</td>
              <td class="text-left" rowspan="1" colspan="1">100ms</td>
              <td class="text-left" rowspan="1" colspan="1">350ms</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Satellite</td>
              <td class="text-left" rowspan="1" colspan="1">350ms</td>
              <td class="text-left" rowspan="1" colspan="1">600ms</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-5.4-5">The computed values reflect both the state of the network path and the
scheduling decisions of the acknowledgement sender. If we
assume that the PATH_ACK will be sent over the terrestrial
link, because this decision provides the best response time, the
computed RTT value for the satellite path will be about 350ms. This is
lower than the 600ms that would be measured if the PATH_ACK came over
the satellite channel, but it is still the right value for computing
for example the PTO timeout: if a PATH_ACK is not received after more
than 350ms, either the data packet or its PATH_ACK were probably lost.<a href="#section-5.4-5" class="pilcrow">¶</a></p>
<p id="section-5.4-6">The simplest implementation is to use the acknowledgment delay
to compute smoothed_rtt and rttvar per
<span><a href="https://rfc-editor.org/rfc/rfc9002#section-5.3" class="relref">Section 5.3</a> of [<a href="#QUIC-RECOVERY" class="cite xref">QUIC-RECOVERY</a>]</span> regardless of the path through which PATH_ACK frames are
received. This approach will provide good results
as long as acknowledgements are sent consistently over the same paths.
If at any time the sender revisits its sending preferences,
this can also change the paths that are used to send acknowledgements.
However, this is not very
different from route changes on a single path.
The RTT, RTT variance and PTO estimates will rapidly converge to
reflect the new conditions.
There is one exception: the minimum RTT, which is also
a known challenge when route changes occurs on a single path.
An acknowledgement receiver
can, however, remember the path over which the PATH_ACK that produced
the minimum RTT was received, and restart the minimum RTT computation
if that acknowledgement path changes or is abandoned.<a href="#section-5.4-6" class="pilcrow">¶</a></p>
<p id="section-5.4-7">Further, congestion control functions that rely on delay estimates needs
to consider cases where acknowledgements are sent over multiple paths
with different delays explicitly.<a href="#section-5.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="packet-scheduling">
<section id="section-5.5">
        <h3 id="name-packet-scheduling">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-packet-scheduling" class="section-name selfRef">Packet Scheduling</a>
        </h3>
<p id="section-5.5-1">The transmission of data packets is limited
by the arrival of data from the application and by congestion control.
Generally, QUIC packets that increase the number of bytes in flight can only be sent
when the congestion window for the selected path allows it.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">Most frames, including control frames (PATH_CHALLENGE and PATH_RESPONSE being the notable
exceptions), can be sent and received on any open path.
As such, a packet scheduler is needed to decide which path to use
for sending the next packet, among those paths with an open congestion window.
If multiple paths are used to send data frames belonging to the same stream,
data delivery will experience the maximum delay of all used paths due to in-order delivery.
The scheduling is a local decision, based on the preferences of the application and the
implementation.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5-3">This implies that an endpoint may send and receive PATH_ACK
frames on a path different from the one that carried the acknowledged
packets. As noted in <a href="#compute-rtt" class="auto internal xref">Section 5.4</a>, RTT estimates computed using
the standard algorithm reflect both the characteristics of the
path and the scheduling algorithm of PATH_ACK frames. The estimates will converge
faster if the scheduling strategy of PATH_ACK frames is stable.
Implementations can choose different strategies such as, for instance, sending
PATH_ACK frames either simply on the path where the acknowledged packets was received,
or alternatively the shortest path, which results in shorter control loops
and potentially better performance.<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<p id="section-5.5-4">Since packets that only carry PATH_ACK frames
are not congestion controlled (see <span><a href="https://rfc-editor.org/rfc/rfc9002#section-7" class="relref">Section 7</a> of [<a href="#QUIC-RECOVERY" class="cite xref">QUIC-RECOVERY</a>]</span>),
senders should carefully consider the load induced
by these packets, especially if the capacity is unknown on that path,
e.g., when that path is not used for sending data frames.<a href="#section-5.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="retransmissions">
<section id="section-5.6">
        <h3 id="name-retransmissions">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-retransmissions" class="section-name selfRef">Retransmissions</a>
        </h3>
<p id="section-5.6-1">Simultaneous use of multiple paths enables different
retransmission strategies to cope with losses such as:
a) retransmitting lost frames over the
same path, b) retransmitting lost frames on a different or
dedicated path, and c) duplicate lost frames on several paths (not
recommended for general purpose use due to the network
overhead). While this document does not preclude a specific
strategy, more detailed specification is out of scope.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2">As noted in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-2.2" class="relref">Section 2.2</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>, STREAM frame boundaries are not
expected to be preserved when data is retransmitted. Especially when STREAM
frames have to be retransmitted over a different path with a smaller MTU limit,
new smaller STREAM frames might need to be sent instead.<a href="#section-5.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pto-expiration">
<section id="section-5.7">
        <h3 id="name-pto-expiration">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-pto-expiration" class="section-name selfRef">PTO Expiration</a>
        </h3>
<p id="section-5.7-1">An implementation should follow the mechanism specified in <span>[<a href="#QUIC-RECOVERY" class="cite xref">QUIC-RECOVERY</a>]</span>
for detecting packet loss on each individual path. A special case happens when
the PTO timer expires. According to <span>[<a href="#QUIC-RECOVERY" class="cite xref">QUIC-RECOVERY</a>]</span>, no packet will be declared
lost until either the packet sender receives a new acknowledgement for this path,
or the path itself is finally declared broken. This cautious process minimizes
the risk of spurious retransmissions, but it may cause significant delivery delay
for the frames contained in these "lost packets".<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<p id="section-5.7-2">Endpoints could take advantage of the multipath extension, and retransmit the content
of the delayed packets on other available paths if the congestion control window on these
paths allows.<a href="#section-5.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="paths-having-different-pmtu-sizes">
<section id="section-5.8">
        <h3 id="name-paths-having-different-pmtu">
<a href="#section-5.8" class="section-number selfRef">5.8. </a><a href="#name-paths-having-different-pmtu" class="section-name selfRef">Paths Having Different PMTU Sizes</a>
        </h3>
<p id="section-5.8-1">An implementation should take care to handle different PMTU sizes across
multiple paths. As specified in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-14.3" class="relref">Section 14.3</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> the
DPLPMTUD Maximum Packet Size (MPS) is maintained for each combination of local and remote IP addresses.
One simple option, if the PMTUs are relatively similar, is to apply the minimum PMTU of all paths to
each path. The benefit of such an approach is to simplify retransmission
processing as the content of lost packets initially sent on one path can be sent
on another path without further frame scheduling adaptations.<a href="#section-5.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="idle-time-close">
<section id="section-5.9">
        <h3 id="name-idle-timeout-and-keep-alive">
<a href="#section-5.9" class="section-number selfRef">5.9. </a><a href="#name-idle-timeout-and-keep-alive" class="section-name selfRef">Idle Timeout and Keep-Alives</a>
        </h3>
<p id="section-5.9-1"><span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> defines an idle timeout for closing the connection
which applies in case of multipath usage
if no packet is received on any path for the duration of the idle timeout.<a href="#section-5.9-1" class="pilcrow">¶</a></p>
<p id="section-5.9-2">This document does not specify per-path idle timeouts. An endpoint
can decide to close a path at any time, whether the path is in active
use or not. For example, an endpoint may wait to send
the initial PATH_ABANDON frame until it anyway sends another frame.
Note that the receiver of an initial PATH_ABANDON frame is, however,
required to immediately reply (see <a href="#path-close" class="auto internal xref">Section 3.4</a>).<a href="#section-5.9-2" class="pilcrow">¶</a></p>
<p id="section-5.9-3">If a path is not actively used for a while, it might not be usable anymore,
e.g. due to middlebox timeouts. To avoid such path breakage, endpoints
can send ack-eliciting packets such as packets containing PING frames
(<span><a href="https://rfc-editor.org/rfc/rfc9000#section-19.2" class="relref">Section 19.2</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>) on that path to keep it alive.
<span><a href="https://rfc-editor.org/rfc/rfc9000#section-5.3" class="relref">Section 5.3</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> defines an optional keep alive process.
This process can be applied to each path separately depending on application needs.
Some applications may decide to not keep any not-actively used path alive,
keep only one additonal path alive, or multiple paths, e.g. for more redunancy.
As discussed in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-10.1.2" class="relref">Section 10.1.2</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>, the keep-alive interval
needs to incorperate timeouts in middleboxes on the path.<a href="#section-5.9-3" class="pilcrow">¶</a></p>
<p id="section-5.9-4">If a path was not actively used for a while and no keep alives have been sent,
an endpoint can probe it before switching to active use if there are still other paths
that are currently usable.<a href="#section-5.9-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">This document defines a new transport parameter to
enable simultaneous use of multiple paths within one QUIC connection.
Further, it specifies new frame types for path management and new error codes
when a path is abandoned.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The current draft defines provisional values for experiments,
but, if the draft is approved, IANA is requested to allocate short values
as permanent with "IETF" as change controller and
the QUIC WG as contact to the respective registries under
<a href="https://www.iana.org/assignments/quic/quic.xhtml">https://www.iana.org/assignments/quic/quic.xhtml</a>.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The following entry in <a href="#transport-parameters" class="auto internal xref">Table 2</a> should be added to
the "QUIC Transport Parameters" registry under the "QUIC Protocol" heading.<a href="#section-6-3" class="pilcrow">¶</a></p>
<span id="name-addition-to-quic-transport-"></span><div id="transport-parameters">
<table class="center" id="table-2">
        <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-addition-to-quic-transport-" class="selfRef">Addition to QUIC Transport Parameters Entries</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
            <th class="text-left" rowspan="1" colspan="1">Parameter Name.</th>
            <th class="text-left" rowspan="1" colspan="1">Specification</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD (current version uses 0x0f739bbc1b666d0d)</td>
            <td class="text-left" rowspan="1" colspan="1">initial_max_path_id</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#nego" class="auto internal xref">Section 2.1</a>
</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-6-5">The following frame types defined in <a href="#frame-types" class="auto internal xref">Table 3</a> should be added to
the "QUIC Frame Types" registry under the "QUIC Protocol" heading.<a href="#section-6-5" class="pilcrow">¶</a></p>
<span id="name-addition-to-quic-frame-type"></span><div id="frame-types">
<table class="center" id="table-3">
        <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-addition-to-quic-frame-type" class="selfRef">Addition to QUIC Frame Types Entries</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
            <th class="text-left" rowspan="1" colspan="1">Frame Name</th>
            <th class="text-left" rowspan="1" colspan="1">Specification</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD-00 - TBD-01 (experiments use 0x15228c00-0x15228c01)</td>
            <td class="text-left" rowspan="1" colspan="1">PATH_ACK</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#mp-ack-frame" class="auto internal xref">Section 4.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD-02 (experiments use 0x15228c05)</td>
            <td class="text-left" rowspan="1" colspan="1">PATH_ABANDON</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#path-abandon-frame" class="auto internal xref">Section 4.2</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD-03 (experiments use 0x15228c07)</td>
            <td class="text-left" rowspan="1" colspan="1">PATH_BACKUP</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#path-backup-available-frame" class="auto internal xref">Section 4.3</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD-04 (experiments use 0x15228c08)</td>
            <td class="text-left" rowspan="1" colspan="1">PATH_AVAILABLE</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#path-backup-available-frame" class="auto internal xref">Section 4.3</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD-05 (experiments use 0x15228c09)</td>
            <td class="text-left" rowspan="1" colspan="1">PATH_NEW_CONNECTION_ID</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#mp-new-conn-id-frame" class="auto internal xref">Section 4.4</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD-06 (experiments use 0x15228c0a)</td>
            <td class="text-left" rowspan="1" colspan="1">PATH_RETIRE_CONNECTION_ID</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#mp-retire-conn-id-frame" class="auto internal xref">Section 4.5</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD-07 (experiments use 0x15228c0c)</td>
            <td class="text-left" rowspan="1" colspan="1">MAX_PATH_ID</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#max-paths-frame" class="auto internal xref">Section 4.6</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD-08 (experiments use 0x15228c0d)</td>
            <td class="text-left" rowspan="1" colspan="1">PATHS_BLOCKED</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#paths-and-cids-blocked-frame" class="auto internal xref">Section 4.7</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD-09 (experiments use 0x15228c0e)</td>
            <td class="text-left" rowspan="1" colspan="1">PATH_CIDS_BLOCKED</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#paths-and-cids-blocked-frame" class="auto internal xref">Section 4.7</a>
</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-6-7">The following transport error code defined in <a href="#tab-error-code" class="auto internal xref">Table 4</a> are to
be added to the "QUIC Transport Error Codes" registry under
the "QUIC Protocol" heading.<a href="#section-6-7" class="pilcrow">¶</a></p>
<span id="name-error-codes-for-multipath-q"></span><div id="tab-error-code">
<table class="center" id="table-4">
        <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-error-codes-for-multipath-q" class="selfRef">Error Codes for Multipath QUIC</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
            <th class="text-left" rowspan="1" colspan="1">Code</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
            <th class="text-left" rowspan="1" colspan="1">Specification</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD-10 (experiments use 0x004150504142414e)</td>
            <td class="text-left" rowspan="1" colspan="1">APPLICATION_ABANDON</td>
            <td class="text-left" rowspan="1" colspan="1">Path abandoned at the application's request</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#error-codes" class="auto internal xref">Section 4.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD-11 (experiments use 0x0052534c494d4954)</td>
            <td class="text-left" rowspan="1" colspan="1">RESOURCE_LIMIT_REACHED</td>
            <td class="text-left" rowspan="1" colspan="1">Path abandoned due to resource limitations in the transport</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#error-codes" class="auto internal xref">Section 4.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD-12 (experiments use 0x00554e5f494e5446)</td>
            <td class="text-left" rowspan="1" colspan="1">UNSTABLE_INTERFACE</td>
            <td class="text-left" rowspan="1" colspan="1">Path abandoned due to unstable interfaces</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#error-codes" class="auto internal xref">Section 4.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD-13 (experiments use 0x004e4f5f4349445f)</td>
            <td class="text-left" rowspan="1" colspan="1">NO_CID_AVAILABLE</td>
            <td class="text-left" rowspan="1" colspan="1">Path abandoned due to no available connection IDs for the path</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#error-codes" class="auto internal xref">Section 4.2.1</a>
</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">The multipath extension retains all security properties of <span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> and <span>[<a href="#QUIC-TLS" class="cite xref">QUIC-TLS</a>]</span>
but requires some additional consideration regarding:<a href="#section-7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1">
          <p id="section-7-2.1.1">potential additional resource usage for per-path connection IDs and multiple concurrent path contexts;<a href="#section-7-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-2.2">
          <p id="section-7-2.2.1">a potentially increased amplification risk for request forgery attacks if multiple paths are used simultaneously;<a href="#section-7-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-2.3">
          <p id="section-7-2.3.1">changes to the nonce calculation due to the use of multiple packet number spaces.<a href="#section-7-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="memory-allocation-for-per-path-resources">
<section id="section-7.1">
        <h3 id="name-memory-allocation-for-per-p">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-memory-allocation-for-per-p" class="section-name selfRef">Memory Allocation for Per-Path Resources</a>
        </h3>
<p id="section-7.1-1">The maximum path ID limit in initial_max_path_id or MAX_PATH_ID frame
limits the number of paths an endpoint is willing
to maintain and thereby also limits the associated path resources.
Furthermore, as connection IDs have to be issued by both endpoints for the
same path ID before an endpoint can open a path, each endpoint could also
control the per-path resource usage by only
issuing connection IDs for a limited number of paths. However, using
the maximum path ID limit in initial_max_path_id or the MAX_PATH_ID frame is preferred.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">To avoid unnecessary resource usage that could be exploited
in a resource exhaustion attack, endpoints SHOULD allocate additional path resources,
such as e.g. for packet number handling, only after path validation has successfully completed.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="request-forgery-with-spoofed-address">
<section id="section-7.2">
        <h3 id="name-request-forgery-with-spoofe">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-request-forgery-with-spoofe" class="section-name selfRef">Request Forgery with Spoofed Address</a>
        </h3>
<p id="section-7.2-1">Path validation as specified in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-8.2." class="relref">Section 8.2.</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>
for migration is used
unchanged for path initiation in this extension. Therefore, the security considerations
on source address spoofing as outlined in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-21.5.4" class="relref">Section 21.5.4</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> equally apply.
Similarly, the anti-amplification limits as specified in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-8" class="relref">Section 8</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> need to be
followed to limit the amplification risk.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2"><span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span> only allows the use of one path
and the number of concurrent path validation attempts is
limited by number of issued connection IDs.
This extension, however, allows for multiple open paths that could in theory be migrated
all at the same time. Further multiple paths could be initialized
simultaneously. Each open path could be used to further amplify an attack.
Therefore, endpoints need to limit the maximum number of paths and might consider
additional measures to limit the number of concurrent path validation processes
e.g. by pacing them out or limiting the number of path initiation attempts
over a certain time period.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cryptographic-handshake-and-aead-nonce">
<section id="section-7.3">
        <h3 id="name-cryptographic-handshake-and">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-cryptographic-handshake-and" class="section-name selfRef">Cryptographic handshake and AEAD Nonce</a>
        </h3>
<p id="section-7.3-1">The multipath extension as specified in this document is only enabled after a
successful handshake when both endpoints indicate support for this extension.
Respectively, all new frames defined in this extension are only used in 1-RTT packets.
As the handshake is not changed by this extension, the transport security mechanisms
as specified in <span>[<a href="#QUIC-TLS" class="cite xref">QUIC-TLS</a>]</span>, such as encryption key exchange and peer authentication,
remain unchanged. As such, the respective security considerations in <span>[<a href="#QUIC-TLS" class="cite xref">QUIC-TLS</a>]</span> apply unaltered. However, note that the limits as discussed on Appendix B of <span>[<a href="#QUIC-TLS" class="cite xref">QUIC-TLS</a>]</span>
apply to the total number of packets sent on all paths.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">This specification changes the AEAD calculation by using the path ID as part of
AEAD nonce (see <a href="#nonce" class="auto internal xref">Section 2.4</a>). To ensure unique nonces, path IDs
are limited to 32 bits and cannot be reused for another path of the same connection.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="contributors">
<section id="section-8">
      <h2 id="name-contributors">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-8-1">This document is a collaboration of authors that combines work from
three proposals. Further contributors that were also involved
one of the original proposals are:<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">
          <p id="section-8-2.1.1">Qing An<a href="#section-8-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.2">
          <p id="section-8-2.2.1">Zhenyu Li<a href="#section-8-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="acknowledgments">
<section id="section-9">
      <h2 id="name-acknowledgments">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-9-1">Thanks to Marten Seemann, Kazuho Oku, Martin Thomson, Magnus Westerlund, Mike Bishop,
Lucas Pardue, Michael Eriksson, Yu Zhu, and Gorry Fairhurst
for their thorough reviews and valuable contributions.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="QUIC-RECOVERY">[QUIC-RECOVERY]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">I. Swett, Ed.</span>, <span class="refTitle">"QUIC Loss Detection and Congestion Control"</span>, <span class="seriesInfo">RFC 9002</span>, <span class="seriesInfo">DOI 10.17487/RFC9002</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9002">https://www.rfc-editor.org/rfc/rfc9002</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC-TLS">[QUIC-TLS]</dt>
        <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">S. Turner, Ed.</span>, <span class="refTitle">"Using TLS to Secure QUIC"</span>, <span class="seriesInfo">RFC 9001</span>, <span class="seriesInfo">DOI 10.17487/RFC9001</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9001">https://www.rfc-editor.org/rfc/rfc9001</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC-TRANSPORT">[QUIC-TRANSPORT]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="OLIA">[OLIA]</dt>
        <dd>
<span class="refAuthor">Khalili, R.</span>, <span class="refAuthor">Gast, N.</span>, <span class="refAuthor">Popovic, M.</span>, <span class="refAuthor">Upadhyay, U.</span>, and <span class="refAuthor">J. Le Boudec</span>, <span class="refTitle">"MPTCP is not pareto-optimal: performance issues and a possible solution"</span>, <span class="seriesInfo">Proceedings of the 8th international conference on Emerging networking experiments and technologies, ACM </span>, <time datetime="2012" class="refDate">2012</time>. </dd>
<dd class="break"></dd>
<dt id="RFC2475">[RFC2475]</dt>
        <dd>
<span class="refAuthor">Blake, S.</span>, <span class="refAuthor">Black, D.</span>, <span class="refAuthor">Carlson, M.</span>, <span class="refAuthor">Davies, E.</span>, <span class="refAuthor">Wang, Z.</span>, and <span class="refAuthor">W. Weiss</span>, <span class="refTitle">"An Architecture for Differentiated Services"</span>, <span class="seriesInfo">RFC 2475</span>, <span class="seriesInfo">DOI 10.17487/RFC2475</span>, <time datetime="1998-12" class="refDate">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2475">https://www.rfc-editor.org/rfc/rfc2475</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6356">[RFC6356]</dt>
        <dd>
<span class="refAuthor">Raiciu, C.</span>, <span class="refAuthor">Handley, M.</span>, and <span class="refAuthor">D. Wischik</span>, <span class="refTitle">"Coupled Congestion Control for Multipath Transport Protocols"</span>, <span class="seriesInfo">RFC 6356</span>, <span class="seriesInfo">DOI 10.17487/RFC6356</span>, <time datetime="2011-10" class="refDate">October 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6356">https://www.rfc-editor.org/rfc/rfc6356</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9743">[RFC9743]</dt>
      <dd>
<span class="refAuthor">Duke, M., Ed.</span> and <span class="refAuthor">G. Fairhurst, Ed.</span>, <span class="refTitle">"Specifying New Congestion Control Algorithms"</span>, <span class="seriesInfo">BCP 133</span>, <span class="seriesInfo">RFC 9743</span>, <span class="seriesInfo">DOI 10.17487/RFC9743</span>, <time datetime="2025-03" class="refDate">March 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9743">https://www.rfc-editor.org/rfc/rfc9743</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="ascii">
<div dir="auto" class="left"><span class="fn nameRole">Yanmei Liu (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Alibaba Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:miaoji.lym@alibaba-inc.com" class="email">miaoji.lym@alibaba-inc.com</a>
</div>
</div>
<div class="alternative-contact">Additional contact information:</div>
<div class="non-ascii">
<div dir="auto" class="left"><span class="fn nameRole">刘彦梅 (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Alibaba Inc.</span></div>
</div>
</address>
<address class="vcard">
        <div class="ascii">
<div dir="auto" class="left"><span class="fn nameRole">Yunfei Ma</span></div>
<div dir="auto" class="left"><span class="org">Uber Technologies Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:yunfei.ma@uber.com" class="email">yunfei.ma@uber.com</a>
</div>
</div>
<div class="alternative-contact">Additional contact information:</div>
<div class="non-ascii">
<div dir="auto" class="left"><span class="fn nameRole">马云飞</span></div>
<div dir="auto" class="left"><span class="org">Uber Technologies Inc.</span></div>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Quentin De Coninck (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">University of Mons (UMONS)</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:quentin.deconinck@umons.ac.be" class="email">quentin.deconinck@umons.ac.be</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Olivier Bonaventure</span></div>
<div dir="auto" class="left"><span class="org">UCLouvain and Tessares</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:olivier.bonaventure@uclouvain.be" class="email">olivier.bonaventure@uclouvain.be</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christian Huitema</span></div>
<div dir="auto" class="left"><span class="org">Private Octopus Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:huitema@huitema.net" class="email">huitema@huitema.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mirja Kuehlewind (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mirja.kuehlewind@ericsson.com" class="email">mirja.kuehlewind@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
